<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Multivariate Linear Least Squares Minimization</title>
  <meta name="description" content="        Multivariate Linear Least Squares Minimization    Multivariate Linear Least Squares Minimization In Linear Least Squares Minimization, we considered ...">

  <link rel="canonical" href="https://maystey.github.io/uct_nassp_cm/regression/multivariate-least-squares.html">
  <link rel="alternate" type="application/rss+xml" title="AST4007W Computational Methods" href="https://maystey.github.io/uct_nassp_cm/feed.xml">

  <meta property="og:url"         content="https://maystey.github.io/uct_nassp_cm/regression/multivariate-least-squares.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Multivariate Linear Least Squares Minimization" />
<meta property="og:description" content="        Multivariate Linear Least Squares Minimization    Multivariate Linear Least Squares Minimization In Linear Least Squares Minimization, we considered ..." />
<meta property="og:image"       content="https://maystey.github.io/uct_nassp_cm/images/logo/UCTcircular_logo.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://maystey.github.io/uct_nassp_cm/regression/multivariate-least-squares.html",
  "headline": "Multivariate Linear Least Squares Minimization",
  "datePublished": "2020-05-05T00:49:24+02:00",
  "dateModified": "2020-05-05T00:49:24+02:00",
  "description": "        Multivariate Linear Least Squares Minimization    Multivariate Linear Least Squares Minimization In Linear Least Squares Minimization, we considered ...",
  "author": {
    "@type": "Person",
    "name": "Mayhew Steyn"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://maystey.github.io/uct_nassp_cm",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://maystey.github.io/uct_nassp_cm",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/uct_nassp_cm/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/uct_nassp_cm/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/uct_nassp_cm/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/uct_nassp_cm/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/uct_nassp_cm';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/uct_nassp_cm/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn o-tooltip--left" data-tooltip="Interactive Mode">
    <img src="/uct_nassp_cm/assets/images/edit-button.svg" alt="Start thebelab interactive mode">
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>


<script src="https://unpkg.com/thebelab@latest/lib/index.js" async></script>
<script>
    /**
     * Add attributes to Thebelab blocks
     */

    const initThebelab = () => {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all code cells, replace with Thebelab interactive code cells
            const codeCells = document.querySelectorAll('.input_area pre')
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)

                // Clean up the language to make it work w/ CodeMirror and add it to the cell
                dataLanguage = ""
                dataLanguage = detectLanguage(dataLanguage);
                codeCell.setAttribute('data-language', dataLanguage)
                codeCell.setAttribute('data-executable', 'true')

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll('.copybtn, .thebebtn')
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale
            const outputs = document.querySelectorAll('.output *, .output')
            outputs.forEach((output, index) => {
                output.remove();
            });

            // Find any cells with an initialization tag and ask ThebeLab to run them when ready
            var thebeInitCells = document.querySelectorAll('div.tag_thebelab-init');
            thebeInitCells.forEach((cell) => {
                console.log("Initializing ThebeLab with cell: " + cell.id);
                cell.querySelector('.thebelab-run-button').click();
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
        });
    }

    // Initialize Thebelab
    initFunction(initThebelab);

// Helper function to munge the language name
var detectLanguage = (language) => {
    if (language.indexOf('python') > -1) {
        language = "python";
    }
    return language;
}
</script>



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/uct_nassp_cm/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  


  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/uct_nassp_cm/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/uct_nassp_cm/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/uct_nassp_cm/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/uct_nassp_cm/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/uct_nassp_cm/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/uct_nassp_cm/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "YOUR-ORG/YOUR-REPO",
    ref: "gh-pages",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python37364bitbaseconda97808f46a65a4f1e9dfdbcff18a07fbf",
    path: "content/regression"
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="http://www.ast.uct.ac.za/ast/postgraduate/4007w"><img src="/uct_nassp_cm/images/logo/UCTcircular_logo.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">AST4007W Computational Methods</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/intro.html"
        >
          
          Home
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="https://github.com/maystey/uct_nassp_cm">
        <a class="c-sidebar__entry"
          href="https://github.com/maystey/uct_nassp_cm"
        >
          
          GitHub repository
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/intro/intro.html"
        >
          
          Introduction
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/basics/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/basics/intro.html"
        >
          
          Python Basics
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/variables">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/variables.html"
              >
                
                Variables
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/comments">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/comments.html"
              >
                
                Comments
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/types">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/types.html"
              >
                
                Type Conversion
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/operators.html"
              >
                
                Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/assignment-operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/assignment-operators.html"
              >
                
                Assignment Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/functions">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/functions.html"
              >
                
                Introduction to Functions
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/strings">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/strings.html"
              >
                
                Strings
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/string-formatting">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/string-formatting.html"
              >
                
                String Formatting
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/data-structures/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/data-structures/intro.html"
        >
          
          Data Structures
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data-structures/tuple">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/data-structures/tuple.html"
              >
                
                Tuple
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data-structures/lists">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/data-structures/lists.html"
              >
                
                Lists
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data-structures/dictionaries">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/data-structures/dictionaries.html"
              >
                
                Dictionaries
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/if-statements/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/if-statements/intro.html"
        >
          
          If Statements
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/bools">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/bools.html"
              >
                
                Booleans
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/comparison-operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/comparison-operators.html"
              >
                
                Comparison Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/logical-operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/logical-operators.html"
              >
                
                Logical Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/if">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/if.html"
              >
                
                If Statements
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/loops/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/loops/intro.html"
        >
          
          Loops
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/for">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/for.html"
              >
                
                For Loops
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/list-comp">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/list-comp.html"
              >
                
                List Comprehension
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/while">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/while.html"
              >
                
                While Loops
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/break">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/break.html"
              >
                
                Breaking Out of Loops
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/else">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/else.html"
              >
                
                Else Statement and Loops
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/functions/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/functions/intro.html"
        >
          
          Functions
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/return">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/return.html"
              >
                
                Return Statement
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/arguments">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/arguments.html"
              >
                
                Arguments
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/local-variables">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/local-variables.html"
              >
                
                Local Variables
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/recursive">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/recursive.html"
              >
                
                Recursive Functions
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/file-io/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/file-io/intro.html"
        >
          
          File I/O
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/file-io/file-io">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/file-io/file-io.html"
              >
                
                File I/O
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/file-io/data">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/file-io/data.html"
              >
                
                Data Files
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/benchmarking/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/benchmarking/intro.html"
        >
          
          Benchmarking
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/benchmarking/time">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/benchmarking/time.html"
              >
                
                Measuring Time in Python
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/benchmarking/uncertainty">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/benchmarking/uncertainty.html"
              >
                
                Uncertainty
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/numpy/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/numpy/intro.html"
        >
          
          NumPy
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/arrays">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/arrays.html"
              >
                
                Arrays
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/array-methods">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/array-methods.html"
              >
                
                Array Methods and Attributes
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/arrays2d">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/arrays2d.html"
              >
                
                2D Arrays and Matrices
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/random">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/random.html"
              >
                
                Random Sampling
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/where">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/where.html"
              >
                
                Array Conditional Statements and numpy.where()
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/matplotlib/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/matplotlib/intro.html"
        >
          
          Matplotlib
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/matplotlib/simple">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/matplotlib/simple.html"
              >
                
                Simple Plots With Pyplot
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/matplotlib/subplots">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/matplotlib/subplots.html"
              >
                
                Subplots
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/regression/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/regression/intro.html"
        >
          
          Regression and SciPy
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/least-squares">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/least-squares.html"
              >
                
                Linear Least Squares Minimization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/chi-squared">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/chi-squared.html"
              >
                
                Linear Chi Squared Minimization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/multivariate-least-squares">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/multivariate-least-squares.html"
              >
                
                Multivariate Linear Least Squares Minimization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/scipy">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/scipy.html"
              >
                
                Nonlinear Least Squares Minimization with scipy.optimize.leastsq
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/uct_nassp_cm/assets/images/download-solid.svg" alt="Download" /></button>
    <div class="download-buttons">
        <a href="/uct_nassp_cm/content/regression/multivariate-least-squares.ipynb" download>
        <button id="interact-button-download" class="interact-button">.ipynb</button>
        </a>
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


  <button id="interact-button-thebelab" class="interact-button">Thebelab</button>

  
  
  


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/uct_nassp_cm/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/uct_nassp_cm/search.html" class="topbar-right-button" id="search-button">
    <img src="/uct_nassp_cm/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Multivariate Linear Least Squares Minimization</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Multivariate-Linear-Least-Squares-Minimization">Multivariate Linear Least Squares Minimization<a class="anchor-link" href="#Multivariate-Linear-Least-Squares-Minimization"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <a href="/linear-regression/least-squares">Linear Least Squares Minimization</a>, we considered the linear functional relation between two measurable variables, $x$ and $y$:</p>
$$
y = a_0 + a_1 x
$$<p>where $a_0$ and $a_1$ are unknown conditions to be determined.</p>
<p>On this page we will look at the more generic case, where we solve the problem for an arbitrary number of variables and constants.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Three-Variables">Three Variables<a class="anchor-link" href="#Three-Variables"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's start by solving this problem for three measurable variables: $y$, $x_1$ and $x_2$, in the linear functional relation:</p>
$$
y = a_0 + a_1 x_1 + a_2 x_2
$$<p>where $a_0$, $a_1$ and $a_2$ are unknown coefficients.</p>
<p>Consider a data set of measured $(x_{1i}, x_{2i}, y_i)$ pairs for $i = 1, 2, 3, \dots , N$. If we attribute the dispersion of this data from the functional relation to error in the $y_i$ terms, $\epsilon_i$, then we can relate the data points with:</p>
$$
\begin{align*}
y_i + \epsilon_i &amp;= a_0 + a_1 x_{1 i} + a_2 x_{2 i}\\
\therefore \epsilon_i = a_0 + a_1 x_{1 i} + a_2 x_{2 i} - y_i\\
\end{align*}
$$<p>The sum of errors squared is given by:</p>
$$
\begin{align*}
S &amp;= \sum_{i = 1}^N \epsilon_i^2 \\
  &amp;= \sum_{i=1}^N (a_0 + a_1 x_{1i} + a_2 x_{2i} - y_i)\\
\end{align*}
$$<p>We want to minimize $S$ with respect to each of the constants, $a_0$, $a_1$ and $a_2$:</p>
$$
\frac{\partial S}{\partial a_0} = 2 \sum_{i=0}^n (a_0 + a_1x_{1i} + a_2x_{2i} - y_i) = 0
$$<p>,
$$
\frac{\partial S}{\partial a_1} = 2 \sum_{i=0}^n (a_0 + a_1x_{1i} + a_2x_{2i} - y_i)x_{1i} = 0
$$
and
$$
\frac{\partial S}{\partial a_2} = 2 \sum_{i=0}^n (a_0 + a_1x_{1i} + a_2x_{2i} - y_i)x_{2i} = 0
$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Re-arranging the above equations and using our statistical notation yields:</p>
$$
a_0 + a_1 \langle x_1 \rangle + a_2 \langle x_2 \rangle = \langle y \rangle
$$<p>,</p>
$$
a_0\langle x_1\rangle + a_1\langle x_1^2\rangle + a_2\langle x_1x_2 \rangle = \langle x_1y \rangle\\
$$<p>and</p>
$$
a_0\langle x_2\rangle + a_1\langle x_1x_2\rangle + a_2\langle x_2^2\rangle = \langle x_2y\rangle
$$<p>This time algebraic manipulation is a lot more work, instead we shall use a matrix equation (which will serve us better in the more generic case to come). The matrix equation representation is:</p>
$$
\begin{pmatrix}
  1     &amp;\langle x_1\rangle     &amp;\langle{x_2}\rangle\\
  \langle{x_1}\rangle   &amp;\langle{x_1^2}\rangle      &amp;\langle{x_1x_2}\rangle\\
  \langle{x_2}\rangle   &amp;\langle{x_1x_2}\rangle &amp;\langle{x_2^2}\rangle\\
 \end{pmatrix}
  \begin{pmatrix}
  a_0\\
  a_1\\
  a_2\\
 \end{pmatrix}
 = 
 \begin{pmatrix}
  \langle{y}\rangle\\
  \langle{x_1 y}\rangle\\
  \langle{x_2 y}\rangle
 \end{pmatrix}
$$<p>This can easily be solved numerically using:
$$
\begin{align*}
\boldsymbol{X}\boldsymbol{A} &amp;= \boldsymbol{Y}\\ 
\therefore \boldsymbol{A} &amp;= \boldsymbol{X}^{-1} \boldsymbol{Y}\\
\end{align*}
$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example---Cepheid-Variables">Example - Cepheid Variables<a class="anchor-link" href="#Example---Cepheid-Variables"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You now have all you need to find the unknown coefficients for the full functional relation of the magnitude ($M$), period ($P$) and color ($B-V$) of the Cepheid variables:</p>
$$
M = a_0 + a_1 \log P + a_2 (B - V)
$$<p>using the same data file as before. (You should find the values $a_0 = -2.15$ mag, $a_1 = -3.12$ mag and $a_2 = 1.49$)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Arbitrarily-Many-Variables">Arbitrarily Many Variables<a class="anchor-link" href="#Arbitrarily-Many-Variables"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider a linear functional relation between measurable variables $x_1$, $x_2$, $x_3$, $\dots$, $x_m$ and $y$:</p>
$$
\begin{align*}
y   &amp;= a_0 + a_1 x_1 + a_2 x_2 + \dots + a_m x_m\\
    &amp;= a_0 + \sum_{j = 1}^m a_j x_j\\
\end{align*}
$$<p>where $a_0$, $a_1$, $\dots$ and $a_m$ are unknown constants.</p>
<p>Suppose we have a data set of measured $(x_{1i}, x_{2i}, \dots, x_{mi}, y_i)$ values for $i = 1, 2, 3, \dots, N$. As before, we assume that the dispersion in our data from the functional relation is due to error in the $y_i$ data points only. Therefore we can write the relation between our data points as:</p>
$$
y_i + \epsilon_i = a_0 + \sum_{j = 1}^m a_j x_{ji}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The sum of errors squared can thus be written as:</p>
$$
S = \sum_{i=1}^N \bigg(a_0 + \bigg(\sum_{j=1}^m a_j x_{ji} \bigg) - y_i\bigg)^2
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We want to find the values of $a_0$, $a_1$, $\dots$ and $a_m$ which gives us the minimum value of $S$. Minimizing $S$ with respect to $a_0$ gives us:</p>
$$
\frac{\partial S}{\partial a_0} = 2 \sum_{i=1}^N \bigg(a_0 + \bigg(\sum_{j=1}^m a_j x_{ji} \bigg) - y_i\bigg) = 0
$$<p>Distributing the sum over $i$ amongst the terms:</p>
$$
\therefore N a_0 + \bigg(\sum_{j=1}^m a_j \sum_{i=1}^N x_{ji} \bigg) - \sum_{i=1}^N y_i = 0
$$<p>Dividing by $N$:</p>
$$
\therefore a_0 + \bigg(\sum_{j=1}^m a_j \frac{1}{N}\sum_{i=1}^N x_{ji} \bigg) - \frac{1}{N}\sum_{i=1}^N y_i = 0
$$<p>Using our stats notation:</p>
$$
\therefore a_0 + \sum_{j=1}^m a_j \langle{x_{j}}\rangle = \langle{y}\rangle
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's minimize $S$ with respect to one of the $a_k$ for $k = 1, 2, \dots, m$, following a similar line of algebraic manipulation as above:</p>
$$
\begin{align*}
\frac{\partial S}{\partial a_k} = \sum_{i=1}^N 2 x_{ki} \bigg(a_0 + \bigg(\sum_{j=1}^m a_j x_{ji} \bigg) - y_i\bigg) &amp;= 0\\
\therefore a_0 \sum_{i=1}^N x_{ki} + \sum_{j=1}^m a_j \bigg(\sum_{i=1}^N x_{ki} x_{ji} \bigg) - \sum_{i=1}^N x_{ki} y_i &amp;= 0\\
\therefore a_0 \langle{x_{k}}\rangle + \sum_{j=1}^m a_j \langle{x_k x_j}\rangle &amp;= \langle{x_k y}\rangle\\
\end{align*}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Writing the results for $a_0$ and $a_k$ ($k = 1,\dots,m$) into a system of equations, expanding the sum over $j$:</p>
$$\begin{eqnarray*}
a_0 &amp;+&amp; a_1 \langle{x_1}\rangle &amp;+&amp; a_2 \langle{x_2}\rangle  &amp;+&amp; \dots &amp;+&amp; a_m \langle{x_m}\rangle &amp;=&amp; \langle{y}\rangle\\
a_0 \langle{x_{1}}\rangle &amp;+&amp; a_1 \langle{x_1~^2}\rangle &amp;+&amp; a_2 \langle{x_1 x_2}\rangle &amp;+&amp; \cdots &amp;+&amp; a_m \langle{x_1 x_m}\rangle &amp;=&amp;  \langle{x_1 y}\rangle\\
a_0 \langle{x_{2}}\rangle &amp;+&amp; a_1 \langle{x_2 x_1}\rangle &amp;+&amp; a_2 \langle{x_2~^2}\rangle &amp;+&amp; \cdots &amp;+&amp; a_m \langle{x_2 x_m}\rangle &amp;=&amp;  \langle{x_2 y}\rangle\\
a_0 \langle{x_{3}}\rangle &amp;+&amp; a_1 \langle{x_3 x_1}\rangle &amp;+&amp; a_2 \langle{x_3 x_2}\rangle &amp;+&amp; \cdots &amp;+&amp; a_m \langle{x_3 x_m}\rangle &amp;=&amp;  \langle{x_3 y}\rangle\\
\vdots ~~~~ &amp;+&amp; ~~~~\vdots &amp;+&amp; ~~~~\vdots &amp;+&amp; \ddots &amp;+&amp; ~~~~\vdots &amp;=&amp; ~~~\vdots\\
a_0 \langle{x_{m}}\rangle &amp;+&amp; a_1 \langle{x_m x_1}\rangle &amp;+&amp; a_2 \langle{x_m x_2}\rangle &amp;+&amp; \cdots &amp;+&amp; a_m \langle{x_m~^2}\rangle &amp;=&amp;  \langle{x_m y}\rangle\\
\end{eqnarray*}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To solve these equations numerically, we can reformulate these equations into a matrix equation:</p>
$$
\begin{pmatrix}
1                     &amp; \langle{x_1}\rangle      &amp; \langle{x_2}\rangle      &amp; \cdots &amp; \langle{x_m}\rangle\\
\langle{x_1}\rangle   &amp; \langle{x_1~^2}\rangle   &amp; \langle{x_1 x_2}\rangle  &amp; \cdots &amp; \langle{x_1 x_m}\rangle\\
\langle{x_2}\rangle   &amp; \langle{x_2 x_1}\rangle  &amp; \langle{x_2~^2}\rangle   &amp; \cdots &amp; \langle{x_2 x_m}\rangle\\
\vdots                &amp; \vdots                   &amp; \vdots                   &amp; \ddots &amp; \vdots\\
\langle{x_m}\rangle   &amp; \langle{x_m x_1}\rangle  &amp; \langle{x_m x_2}\rangle  &amp; \cdots &amp; \langle{x_m~^2}\rangle\\
\end{pmatrix}
\begin{pmatrix}
a_0\\
a_1\\
a_2\\
\vdots\\
a_m\\
\end{pmatrix}
=
\begin{pmatrix}
\langle{y}\rangle\\
\langle{x_1 y}\rangle\\
\langle{x_2 y}\rangle\\
\vdots\\
\langle{x_m y}\rangle\\
\end{pmatrix}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the left most matrix is symmetric about the diagonal, this can come in handy when computing the matrix elements. As before, this equation can be solved for the $a_i$ by inverting the left most matrix, i.e.</p>
$$
\begin{align*}
\boldsymbol{X} \boldsymbol{A} &amp;= \boldsymbol{Y}\\
\therefore \boldsymbol{A} &amp;= \boldsymbol{X}^{-1} \boldsymbol{Y}\\
\end{align*}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Python-Implementation">Python Implementation<a class="anchor-link" href="#Python-Implementation"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's work on a Python implementation of this solution. You may want to try it yourself before reading further. In order to verify our implementation we will use the Cepheid data we've used so far, though in further exercises you will be given data sets containing more variables.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We start by reading in the file. We will read the data into a 2D array. This can be achieved using the standard library as in the <a href="/file-io/data"><strong>Data Files</strong></a> section in the <strong>File I/O</strong> chapter, or using <code>numpy.loadtxt()</code> (documentation <a href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html">here</a>). We shall use the latter as it is far more convenient: 
<!-- as in the [**File I/O**](/numpy/file-io) section from the **NumPy** chapter. --></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">## Reading in the file</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data/cepheid_data.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>data</code> array contains all of the data points for $y_i, x_{1i}, x_{2i}, x_{3i}, \dots, x_{ji}, \dots, x_{mi}$, where $i = 1, \dots, N$ corresponds to each row of <code>data</code>. Now, we want the data in the format:<!---, the first (or index 0) column contains the $y_i$ values and columns indexed 1 to $m$ contain the $x_{ij}$ values. ---></p>
$$
\begin{eqnarray*}
\begin{matrix}
\texttt{data} = [   &amp; [ y_{1},  &amp; x_{11}, &amp; x_{21}, &amp; \cdots, &amp; x_{m1} &amp;], \\
                    &amp; [ y_{2},  &amp; x_{12}, &amp; x_{22}, &amp; \cdots, &amp; x_{m2} &amp;],\\
                    &amp; [ y_{3},  &amp; x_{13}, &amp; x_{23}, &amp; \cdots, &amp; x_{m3} &amp;],\\
                    &amp; [ ~\vdots~, &amp; \vdots~~, &amp; \vdots~~, &amp; \ddots, &amp; \vdots &amp;],\\
                    &amp; [ y_{N},  &amp; x_{1N}, &amp; x_{2N}, &amp; \cdots, &amp; x_{mN} &amp;]]\\
\end{matrix}
\end{eqnarray*}
$$<p>as this will make slicing it more clear. In the case of the Cepheid variable data, however, we have our "$y$" variable in the central column. Therefore we shall swap column 1 and 0 to better align with our desired data structure:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Swapping data[:, 0] and data[:, 1]</span>
<span class="c1"># Note that this is particular to the data file we are using</span>
<span class="c1"># np.copy is necessaary as arrays are not passed as values by default but as reference</span>

<span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To extract the values of a single variable for each measurement, slice columns out of <code>data</code>. For example, the $y_i$ are contained in the slice <code>data[:, 0]</code>, the $x_{1i}$ are contained in <code>data[:, 1]</code>, the $x_{2i}$ are contained in <code>data[:, 2]</code>, etc.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that for each of the sums along the data sets ($\sum_{i = 1}^N$), we will be summing along the columns. For example, for the quantity:</p>
$$
\langle x_1 \rangle = \frac{1}{N} \sum_{i = 1}^N x_{1i}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Using numpy.mean to calculate the expectation value</span>
<span class="c1">#Note that x1 = data[:,1]</span>

<span class="n">x1_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To calculate an expectation value like</p>
$$
\langle x_1 x_2 \rangle = \frac{1}{N} \sum_{i = 1}^N x_{1 i} x_{2 i}
$$<p>we can use:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x1_x2_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where we've made use of NumPy array's vectorized operation to multiply each element together before taking the mean of the results.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Constructing-the-$\boldsymbol{X}$-Matrix">Constructing the $\boldsymbol{X}$ Matrix<a class="anchor-link" href="#Constructing-the-$\boldsymbol{X}$-Matrix"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we continue, let's break down the structure of the matrix:</p>
$$
\boldsymbol{X} = 
\begin{pmatrix}
1                     &amp; \langle{x_1}\rangle      &amp; \langle{x_2}\rangle      &amp; \langle{x_3}\rangle      &amp; \cdots &amp; \langle{x_m}\rangle\\
\langle{x_1}\rangle   &amp; \langle{x_1~^2}\rangle   &amp; \langle{x_1 x_2}\rangle  &amp; \langle{x_1 x_3}\rangle  &amp; \cdots &amp; \langle{x_1 x_m}\rangle\\
\langle{x_2}\rangle   &amp; \langle{x_2 x_1}\rangle  &amp; \langle{x_2~^2}\rangle   &amp; \langle{x_2 x_3}\rangle  &amp; \cdots &amp; \langle{x_2 x_m}\rangle\\
\langle{x_3}\rangle   &amp; \langle{x_3 x_1}\rangle  &amp; \langle{x_3 x_2}\rangle  &amp; \langle{x_3~^2}\rangle   &amp; \cdots &amp; \langle{x_3 x_m}\rangle\\
\vdots                &amp; \vdots                   &amp; \vdots                   &amp; \vdots                   &amp; \ddots &amp; \vdots\\
\langle{x_m}\rangle   &amp; \langle{x_m x_1}\rangle  &amp; \langle{x_m x_2}\rangle  &amp; \langle{x_m x_3}\rangle  &amp; \cdots &amp; \langle{x_m~^2}\rangle\\
\end{pmatrix}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's construct an empty matrix for which we will fill in the entries as we go:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var_count</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">var_count</span><span class="p">,</span> <span class="n">var_count</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we have created an $(m+1)\times(m+1)$ matrix, where $m+1$ is given by the length of axis-1 of <code>data</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, as we have noted before, $\boldsymbol{X}$ is a symmetric matrix. That is for for row $k$ and column $l$, $\boldsymbol{X}_{k l} = \boldsymbol{X}_{l k}$. We only need to construct one of the triangles of the matrix, the other is obtained for free.</p>
<p>Let's work with the upper triangle of the matrix. Here there are 3 regions with distinguishable structures</p>
<ol>
<li>The first row</li>
<li>The diagonal</li>
<li>The remaining triangle</li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first element of the matrix is just one. The remainder of the first row is simply the expectation value of each of the $x_j$:</p>
$$
\boldsymbol{X}_{0 0} = 1
$$<p>and</p>
$$
\boldsymbol{X}_{0 l} = \langle{x_l}\rangle ~~~~ \text{where}~ l = 1, 2, \dots, m
$$<p>Note that here we are indexing $\boldsymbol{X}$ from 0 to better translate it to code:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># First row and column</span>
<span class="c1"># We leave the first element as is</span>

<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">var_count</span><span class="p">):</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">l</span><span class="p">])</span>
    
    <span class="c1"># Setting the values for the first column</span>
    <span class="c1"># remember that X[k, l] = X[l, k]</span>
    <span class="n">X</span><span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, consider the triangle off of the diagonal. That is the region:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
\begin{pmatrix}
-         &amp; -        &amp; -                         &amp; -                        &amp; \cdots  &amp; - \\
-         &amp; -        &amp; \langle{x_1 x_2}\rangle   &amp; \langle{x_1 x_3}\rangle  &amp; \cdots  &amp; \langle{x_1 x_m}\rangle\\
-         &amp; -        &amp; -                         &amp; \langle{x_2 x_3}\rangle  &amp; \cdots  &amp; \langle{x_2 x_m}\rangle\\
-         &amp; -        &amp; -                         &amp; -                        &amp; \cdots  &amp; \langle{x_3 x_m}\rangle\\
\vdots    &amp; \vdots   &amp; \vdots                    &amp; \vdots                   &amp; \ddots  &amp; \vdots \\
-         &amp; -        &amp; -                         &amp; -                        &amp; \cdots  &amp; \langle{x_m~^2}\rangle\\
\end{pmatrix}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This region exhibits the pattern:</p>
$$
\boldsymbol{X}_{k l} = \langle{x_k x_l}\rangle ~~~~\text{where}~ l &gt; k
$$<p>The diagonal has a fairly simple pattern, starting from (row, column) $(1,1)$:</p>
$$
\boldsymbol{X}_{k k} = \langle{x_k~^2}\rangle
$$<p>Note, however, that this is a special case of the rules for constructing region 3. We can therefore combine regions 2 and 3 with the rule:</p>
$$
\boldsymbol{X}_{k l} = \langle{x_k x_l}\rangle ~~~~\text{where}~ l \geq k
$$<p>In the code this becomes:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Inner matrix</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">var_count</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">var_count</span><span class="p">):</span>
        <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">l</span><span class="p">]</span> <span class="p">)</span>
        
        <span class="c1">#Setting the value for the lower triangle</span>
        <span class="n">X</span><span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That covers the $\boldsymbol{X}$ matrix.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Constructing-the-$\boldsymbol{Y}$-Matrix">Constructing the $\boldsymbol{Y}$ Matrix<a class="anchor-link" href="#Constructing-the-$\boldsymbol{Y}$-Matrix"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's construct the matrix:</p>
$$
\boldsymbol{Y} =
\begin{pmatrix}
\langle{y}\rangle\\
\langle{x_1 y}\rangle\\
\langle{x_2 y}\rangle\\
\vdots\\
\langle{x_m y}\rangle\\
\end{pmatrix}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is fairly straight forward, with</p>
$$
\boldsymbol{Y}_{0, 0} = \langle{y}\rangle
$$<p>and</p>
$$
\boldsymbol{Y}_{k, 0} = \langle{x_k y}\rangle ~~~~\text{where}~ k = 1, \dots, m
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Creating the Y column matrix:</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">var_count</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

<span class="c1">#First entry</span>
<span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#The remainder of the entries</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">var_count</span><span class="p">):</span>
    <span class="n">Y</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Finding-Matrix-$\boldsymbol{A}$-(Or-Solving-For-the-$a_j$)">Finding Matrix $\boldsymbol{A}$ (Or Solving For the $a_j$)<a class="anchor-link" href="#Finding-Matrix-$\boldsymbol{A}$-(Or-Solving-For-the-$a_j$)"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lastly, to solve for our $a_j$ values, we consider the matrix:</p>
$$
\boldsymbol{A}=
\begin{pmatrix}
a_0 \\
a_1\\
a_2\\
\vdots\\
a_m\\
\end{pmatrix}
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This fits into the matrix equation</p>
$$
\boldsymbol{X}\boldsymbol{A} = \boldsymbol{Y}
$$<p>where we've already constructed $\boldsymbol{X}$ and $\boldsymbol{Y}$. All that's left is to solve the equation be inverting $\boldsymbol{X}$:</p>
$$
\boldsymbol{A} = \boldsymbol{X}^{-1} \boldsymbol{Y}
$$<p>To achieve this numerically, we simply take the inverse of <code>X</code>, <code>X.I</code>:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Finding A:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">I</span><span class="o">*</span><span class="n">Y</span>

<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[-2.14515885]
 [-3.11733284]
 [ 1.48566643]]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see are results agree with the specific solution for the the case of 3 variables above.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Putting-it-all-together:">Putting it all together:<a class="anchor-link" href="#Putting-it-all-together:"> </a></h4><p>Let's gather all of the code cells together into a single script. We will also merge the loops together for efficiency:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#Reading the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data/cepheid_data.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Swapping data[:, 0] and data[:, 1]</span>
<span class="c1"># Note that this is particular to the data file we are using</span>
<span class="c1"># np.copy is necessaary as arrays are not passed as values by default but as reference</span>
<span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1">#Creating empty X and Y matrices</span>
<span class="n">var_count</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span> <span class="p">(</span><span class="n">var_count</span><span class="p">,</span> <span class="n">var_count</span><span class="p">)</span> <span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">var_count</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

<span class="c1">#Filling the X and Y matrices</span>

<span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">var_count</span><span class="p">):</span>
    <span class="c1">#First row and column of X</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])</span>
    <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
    
    <span class="c1">#Y</span>
    <span class="n">Y</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    
    <span class="c1">#Inner matrix of X</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">var_count</span><span class="p">):</span>
        <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">l</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">X</span><span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>

<span class="c1">#Calculating A</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">I</span><span class="o">*</span><span class="n">Y</span>

<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[-2.14515885]
 [-3.11733284]
 [ 1.48566643]]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/uct_nassp_cm/regression/chi-squared.html">
       <span class="u-margin-right-tiny"></span> Linear Chi Squared Minimization
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/uct_nassp_cm/regression/scipy.html">
      Nonlinear Least Squares Minimizati... <span class="u-margin-right-tiny"></span> 
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
